# Jenkins Setup Guide for Flutter Project

## Quick Setup Steps

### 1. Install Jenkins

**On Ubuntu/Debian:**
```bash
wget -q -O - https://pkg.jenkins.io/debian-stable/jenkins.io-2023.key | sudo apt-key add -
sudo sh -c 'echo deb http://pkg.jenkins.io/debian-stable binary/ > /etc/apt/sources.list.d/jenkins.list'
sudo apt-get update
sudo apt-get install jenkins
```

**On macOS:**
```bash
brew install jenkins
```

**On Windows:**
- Download Jenkins installer from https://www.jenkins.io/download/
- Run the installer and follow the setup wizard

### 2. Install Required Plugins

After Jenkins is running, go to:
- **Manage Jenkins** → **Manage Plugins** → **Available**

Install these plugins:
- Git
- Pipeline
- Email Extension (optional)
- HTML Publisher (optional)
- Coverage (optional)

### 3. Install Flutter on Jenkins Server

```bash
# Download Flutter
cd /opt
sudo git clone https://github.com/flutter/flutter.git -b stable
sudo chown -R jenkins:jenkins /opt/flutter

# Add to PATH (add to ~/.bashrc or Jenkins environment)
export PATH="$PATH:/opt/flutter/bin"

# Verify installation
flutter doctor
```

### 4. Configure Jenkins Tools

1. Go to **Manage Jenkins** → **Global Tool Configuration**
2. **JDK**: Add JDK installation (Java 17+)
   - Name: `JDK-17`
   - JAVA_HOME: `/usr/lib/jvm/java-17-openjdk-amd64` (adjust for your system)
3. **Flutter**: Configure Flutter SDK
   - Name: `Flutter-Stable`
   - FLUTTER_HOME: `/opt/flutter`

### 5. Create Pipeline Job

1. Click **New Item**
2. Enter name: `Flutter-CI-CD`
3. Select **Pipeline**
4. Click **OK**

### 6. Configure Pipeline

**Pipeline Configuration:**
- **Definition**: Pipeline script from SCM
- **SCM**: Git
- **Repository URL**: `https://github.com/your-username/your-repo.git`
- **Credentials**: (Add if private repo)
- **Branches**: `*/main` or `*/master`
- **Script Path**: `Jenkinsfile`

### 7. Configure GitHub Webhook

**In GitHub:**
1. Go to repository → **Settings** → **Webhooks**
2. Click **Add webhook**
3. **Payload URL**: `http://your-jenkins-ip:8080/github-webhook/`
4. **Content type**: `application/json`
5. **Events**: Select "Just the push event"
6. Click **Add webhook**

**In Jenkins:**
1. Go to **Manage Jenkins** → **Configure System**
2. Find **GitHub** section
3. Add GitHub server
4. Configure credentials if needed

### 8. Test the Pipeline

1. Click **Build Now** in Jenkins
2. Watch the build progress
3. Check console output for any errors
4. Download artifacts (APK/AAB) from build page

## Environment Variables (Optional)

You can add environment variables in Jenkins:
- **Manage Jenkins** → **Configure System** → **Global properties** → **Environment variables**

Common variables:
- `ANDROID_HOME`: Android SDK path
- `JAVA_HOME`: Java installation path
- `FLUTTER_ROOT`: Flutter SDK path

## Email Configuration (Optional)

1. Install **Email Extension Plugin**
2. Go to **Manage Jenkins** → **Configure System**
3. Find **Extended E-mail Notification**
4. Configure SMTP settings:
   - SMTP server: `smtp.gmail.com` (for Gmail)
   - SMTP Port: `587`
   - Use SSL: Yes
   - User Name: Your email
   - Password: App password (for Gmail)
5. Uncomment email sections in Jenkinsfile

## Troubleshooting

### Flutter Command Not Found
- Ensure Flutter is in PATH
- Check Jenkins environment variables
- Verify Flutter installation: `which flutter`

### Build Failures
- Check console output
- Verify Flutter version: `flutter --version`
- Check Java version: `java -version`
- Ensure dependencies: `flutter pub get`

### GitHub Webhook Issues
- Verify webhook URL is accessible
- Check Jenkins logs: `/var/log/jenkins/jenkins.log`
- Test webhook manually from GitHub

### Permission Issues
- Ensure Jenkins user has permissions:
  ```bash
  sudo chown -R jenkins:jenkins /opt/flutter
  sudo chown -R jenkins:jenkins /path/to/android/sdk
  ```

## Next Steps

1. Customize Jenkinsfile for your needs
2. Add code signing for release builds
3. Configure deployment to app stores
4. Set up build notifications (Slack, Teams, etc.)
5. Add more stages (iOS builds, etc.)

